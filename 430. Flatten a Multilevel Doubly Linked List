
import java.util.Stack;

//430. Flatten a Multilevel Doubly Linked List
//leetcode
// 思路：while循环， 碰到child, 就断开连接。 利用 stack 来连接

public class flatten {
	class Node {
		public int val;
		public Node prev;
		public Node next;
		public Node child;

		public Node() {
		}

		public Node(int _val, Node _prev, Node _next, Node _child) {
			val = _val;
			prev = _prev;
			next = _next;
			child = _child;
		}
	};

	public Node flatten(Node root) {
		Node cur = root;
		Stack<Node> stack = new Stack<Node>();

		while (cur != null) {
			if (cur.child != null) {
				stack.push(cur.next);
				cur.next = cur.child;
				if (cur.next != null) {
					cur.next.prev = cur;
				}
				cur.child = null;
			} else if (cur.next == null && !stack.isEmpty()) {
				cur.next = stack.pop();
				if (cur.next != null) {
					cur.next.prev = cur;
				}
			}
			cur = cur.next;
		}
		return root;
	}
}
